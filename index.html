<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>point Log</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  margin: 0;
  font-family: sans-serif;
  background: #f2f2f2;
}
header {
  background: #222;
  color: #fff;
  padding: 12px;
  text-align: center;
  font-size: 20px;
}
main {
  padding: 16px;
  padding-bottom: 80px;
}
.card {
  background: #fff;
  border-radius: 14px;
  padding: 16px;
  margin-bottom: 16px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.1);
}
input, button {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  font-size: 16px;
}
button {
  background: #4CAF50;
  color: #fff;
  border: none;
  border-radius: 10px;
}
.list-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 10px;
}
.delete {
  background: none;
  color: red;
  font-size: 20px;
  border: none;
}
.total {
  font-size: 26px;
  font-weight: bold;
  text-align: center;
}
nav {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  height: 60px;
  background: #fff;
  display: flex;
  border-top: 1px solid #ccc;
}
nav button {
  flex: 1;
  border: none;
  background: none;
  font-size: 14px;
}
.hidden {
  display: none;
}
</style>
</head>

<body>

<header>point Log</header>

<main>

<!-- ãƒ›ãƒ¼ãƒ  -->
<section id="home">
  <div class="card total" id="totalYen">åˆè¨ˆï¼š0 å††</div>
  <div class="card">
    <h3>ä¿å­˜æ¸ˆã¿ãƒã‚¤ãƒ³ãƒˆ</h3>
    <div id="list"></div>
  </div>
</section>

<!-- è¿½åŠ  -->
<section id="add" class="hidden">
  <div class="card">
    <h3>â‘  ã‚¢ãƒ—ãƒªã‚’ç™»éŒ²</h3>
    <input id="appName" placeholder="ã‚¢ãƒ—ãƒªåï¼ˆä¾‹ï¼šæ¥½å¤©ãƒã‚¤ãƒ³ãƒˆï¼‰">
    <input id="ratePoint" type="number" placeholder="ä½•ãƒã‚¤ãƒ³ãƒˆ">
    <input id="rateYen" type="number" placeholder="ä½•å††">
    <button onclick="addApp()">ã‚¢ãƒ—ãƒªã‚’ç™»éŒ²</button>
  </div>

  <div class="card">
    <h3>â‘¡ ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ </h3>
    <input id="pointApp" placeholder="ã‚¢ãƒ—ãƒªå">
    <input id="addPoint" type="number" placeholder="è¿½åŠ ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆ">
    <button onclick="addPoint()">ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ </button>
  </div>
</section>

<!-- è¨­å®š -->
<section id="setting" class="hidden">
  <div class="card">
    <h3>è¨­å®š</h3>
    <p>ä»Šå¾Œè¿½åŠ äºˆå®š</p>
  </div>
</section>

</main>

<nav>
  <button onclick="show('home')">ğŸ  ãƒ›ãƒ¼ãƒ </button>
  <button onclick="show('add')">â• è¿½åŠ </button>
  <button onclick="show('setting')">âš™ï¸ è¨­å®š</button>
</nav>

<script>
let apps = JSON.parse(localStorage.getItem("apps")) || {};

function save() {
  localStorage.setItem("apps", JSON.stringify(apps));
}

function show(id) {
  document.querySelectorAll("section").forEach(s => s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function addApp() {
  const name = appName.value.trim();
  const rp = Number(ratePoint.value);
  const ry = Number(rateYen.value);
  if (!name || rp <= 0 || ry <= 0) {
    alert("æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„");
    return;
  }
  apps[name] = {
    ratePoint: rp,
    rateYen: ry,
    point: apps[name]?.point || 0
  };
  save();
  render();
  alert("ã‚¢ãƒ—ãƒªã‚’ç™»éŒ²ã—ã¾ã—ãŸ");
}

function addPoint() {
  const name = pointApp.value.trim();
  const p = Number(addPoint.value);
  if (!apps[name]) {
    alert("å…ˆã«ã‚¢ãƒ—ãƒªã‚’ç™»éŒ²ã—ã¦ãã ã•ã„");
    return;
  }
  if (p <= 0) {
    alert("ãƒã‚¤ãƒ³ãƒˆæ•°ãŒä¸æ­£ã§ã™");
    return;
  }
  apps[name].point += p;
  save();
  render();
  alert("ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¾ã—ãŸ");
}

function removeApp(name) {
  if (!confirm("å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
  delete apps[name];
  save();
  render();
}

function render() {
  const list = document.getElementById("list");
  list.innerHTML = "";
  let total = 0;

  for (const name in apps) {
    const a = apps[name];
    const yen = a.point * a.rateYen / a.ratePoint;
    total += yen;

    const div = document.createElement("div");
    div.className = "list-item";
    div.innerHTML = `
      <div>
        <strong>${name}</strong><br>
        ${a.point} pt â†’ ${Math.round(yen)} å††
      </div>
      <button class="delete" onclick="removeApp('${name}')">Ã—</button>
    `;
    list.appendChild(div);
  }

  document.getElementById("totalYen").textContent =
    "åˆè¨ˆï¼š" + Math.round(total) + " å††";
}

render();
</script>

</body>
</html>
