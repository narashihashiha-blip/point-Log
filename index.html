<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>point Log</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { margin:0; font-family:sans-serif; background:#f2f2f2; }
header { background:#222; color:#fff; padding:12px; text-align:center; font-size:20px; }
main { padding:16px; padding-bottom:80px; }
.card { background:#fff; border-radius:14px; padding:16px; margin-bottom:16px; box-shadow:0 2px 6px rgba(0,0,0,.1); }
.hidden { display:none; }
input, button { width:100%; padding:10px; margin-top:8px; font-size:16px; }
button { background:#4CAF50; color:#fff; border:none; border-radius:10px; }

nav {
  position:fixed; bottom:0; left:0; right:0;
  height:60px; background:#fff; display:flex; border-top:1px solid #ccc;
}
nav button { flex:1; border:none; background:none; font-size:14px; }

.app-grid {
  display:grid;
  grid-template-columns:repeat(3,1fr);
  gap:14px;
}
.app-icon {
  background:#fff;
  border-radius:16px;
  padding:20px 8px;
  text-align:center;
  box-shadow:0 2px 4px rgba(0,0,0,.15);
  cursor:pointer;
}
.app-icon strong {
  display:block;
  font-size:18px;
}

.bar { height:18px; background:#4CAF50; border-radius:10px; }
.bar-row { margin-bottom:10px; }
.total { font-size:26px; font-weight:bold; text-align:center; }
</style>
</head>

<body>

<header>point Log</header>

<main>

<!-- ãƒ›ãƒ¼ãƒ  -->
<section id="home">
  <div class="card total" id="totalYen">åˆè¨ˆï¼š0 å††</div>

  <div class="card">
    <h3>ã‚¢ãƒ—ãƒªåˆ¥æ®‹é«˜</h3>
    <div id="bars"></div>
  </div>

  <div class="card">
    <h3>ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ª</h3>
    <div class="app-grid" id="homeIcons"></div>
  </div>
</section>

<!-- è¨˜éŒ²ï¼ˆã‚¢ãƒ—ãƒªé¸æŠï¼‰ -->
<section id="record" class="hidden">
  <div class="card">
    <h3>è¨˜éŒ²ã™ã‚‹ã‚¢ãƒ—ãƒªã‚’é¸æŠ</h3>
    <div class="app-grid" id="recordIcons"></div>
  </div>
</section>

<!-- è¨˜éŒ²è©³ç´° -->
<section id="recordDetail" class="hidden">
  <div class="card">
    <h3 id="recordTitle"></h3>
    <input id="addPoint" type="number" placeholder="è¿½åŠ ã™ã‚‹ãƒã‚¤ãƒ³ãƒˆ">
    <button onclick="savePoint()">è¨˜éŒ²ã™ã‚‹</button>
  </div>
</section>

<!-- è¨­å®š -->
<section id="setting" class="hidden">
  <div class="card"><h3>è¨­å®š</h3><p>ä»Šå¾Œè¿½åŠ äºˆå®š</p></div>
</section>

</main>

<nav>
  <button onclick="show('home')">ğŸ  ãƒ›ãƒ¼ãƒ </button>
  <button onclick="show('record')">ğŸ“ è¨˜éŒ²</button>
  <button onclick="show('setting')">âš™ï¸ è¨­å®š</button>
</nav>

<script>
let apps = JSON.parse(localStorage.getItem("apps")) || {};
let currentApp = null;

function save(){ localStorage.setItem("apps", JSON.stringify(apps)); }

function show(id){
  document.querySelectorAll("section").forEach(s=>s.classList.add("hidden"));
  document.getElementById(id).classList.remove("hidden");
}

function openRecord(name){
  currentApp = name;
  recordTitle.textContent = name + " ã®ãƒã‚¤ãƒ³ãƒˆã‚’è¨˜éŒ²";
  addPoint.value = "";
  show("recordDetail");
}

function savePoint(){
  const p = Number(addPoint.value);
  if(p<=0) return alert("ãƒã‚¤ãƒ³ãƒˆæ•°ã‚¨ãƒ©ãƒ¼");
  apps[currentApp].point += p;
  save();
  render();
  show("home");
}

function render(){
  let total=0, max=0;
  bars.innerHTML="";
  homeIcons.innerHTML="";
  recordIcons.innerHTML="";

  for(const n in apps){
    const y = apps[n].point * apps[n].rateYen / apps[n].ratePoint;
    if(y>max) max=y;
  }

  for(const name in apps){
    const a = apps[name];
    const yen = Math.round(a.point * a.rateYen / a.ratePoint);
    total+=yen;

    bars.innerHTML += `
      <div class="bar-row">${name} (${yen}å††)
        <div class="bar" style="width:${max?yen/max*100:0}%"></div>
      </div>`;

    const icon = `<div class="app-icon" onclick="openRecord('${name}')">
      <strong>${yen}</strong>${name}</div>`;

    homeIcons.innerHTML += icon;
    recordIcons.innerHTML += icon;
  }

  homeIcons.innerHTML += `<div class="app-icon" onclick="alert('è¨­å®šç”»é¢ã§è¿½åŠ äºˆå®š')">
    <strong>ï¼‹</strong>è¿½åŠ </div>`;

  totalYen.textContent = "åˆè¨ˆï¼š" + total + " å††";
}

render();
</script>

<script>
  function openRecord() {
    const appName = prompt("ã‚¢ãƒ—ãƒªåã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    if (!appName) return;

    const points = prompt("ãƒã‚¤ãƒ³ãƒˆæ•°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
    if (!points || isNaN(points)) {
      alert("ãƒã‚¤ãƒ³ãƒˆæ•°ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„");
      return;
    }

    alert(
      "ã€è¨˜éŒ²å®Œäº†ã€‘\n" +
      appName + " ã« " + points + " ãƒã‚¤ãƒ³ãƒˆã‚’è¨˜éŒ²ã—ã¾ã—ãŸ"
    );
  }
</script>
</body>
</html>
